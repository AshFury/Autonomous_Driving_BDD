# Model Explanation  
**Applied Computer Vision Assignment – Object Detection on BDD100K**

---

# 1. Model Choice

## Selected Model:
**Faster R-CNN with ResNet50-FPN backbone**

The chosen model for this task is Faster R-CNN, implemented via the torchvision model zoo.

---

# 2. Why Faster R-CNN?

Faster R-CNN was selected for the following reasons:

### 1. Proven Performance
- Two-stage detectors consistently provide strong localization accuracy.
- Well-established benchmark model for object detection tasks.

### 2. Suitable for Medium-Sized Datasets
- Works well with moderate training sizes.
- Robust when fine-tuned from COCO pre-trained weights.

### 3. Interpretable Architecture
- Clear separation between:
  - Feature extraction
  - Region proposal
  - Classification and bounding box regression

This makes it easier to explain model behavior and debug training issues.

### 4. Multi-Class Detection Support
- Naturally handles multiple detection classes.
- Easy to adapt final classification head to custom class count.

---

# 3. Architecture Overview

Faster R-CNN consists of three major components:

---

## 3.1 Backbone: ResNet50

ResNet50 is used as the feature extractor.

### Why ResNet50?

- Deep residual network (50 layers)
- Skip connections mitigate vanishing gradients
- Strong general-purpose feature extractor
- Pretrained weights available (COCO)

Residual connections allow stable deep feature learning, making it effective for complex urban scenes such as BDD100K.

---

## 3.2 Feature Pyramid Network (FPN)

FPN enhances multi-scale feature representation.

### Why FPN?

BDD100K contains objects of widely varying sizes:
- Small traffic lights
- Medium pedestrians
- Large buses and trucks

FPN:
- Combines low-level spatial features with high-level semantic features
- Improves small-object detection
- Enables multi-scale robustness

This was particularly important given dataset analysis showed:
- ~55% of objects are small

---

## 3.3 Region Proposal Network (RPN)

The RPN generates candidate object regions.

Steps:
1. Sliding window over feature maps
2. Anchor generation at multiple scales
3. Binary classification (object vs background)
4. Bounding box regression

The RPN significantly reduces computational cost compared to earlier region proposal methods.

---

## 3.4 ROI Heads

For each proposed region:

- ROI Align extracts fixed-size feature maps
- Fully connected layers perform:
  - Classification
  - Bounding box refinement

---

# 4. Background Class Handling

Although BDD detection contains 10 object classes, Faster R-CNN internally requires:
`num_classes = 10 + 1 (background)`


Background represents:
- Non-object regions
- Negative proposals generated by RPN

Without background class:
- Cross-entropy loss becomes invalid
- Training would fail due to label mismatch

Thus:
`NUM_CLASSES = 11`


---

# 5. Training Pipeline

## 5.1 Dataset Loader

A custom PyTorch `Dataset` was implemented:

- Parses BDD JSON annotations
- Converts bounding boxes into tensor format
- Maps class names to integer labels
- Filters non-detection categories
- Returns:
  - Image tensor
  - Target dictionary

This satisfies the assignment requirement to build a loader and training pipeline.

---

## 5.2 Training Configuration

- Training subset: 1000 images
- Epochs: 5
- Batch size: 2
- Optimizer: AdamW
- Initial Learning Rate: 1e-4
- Scheduler: StepLR (step_size=2, gamma=0.1)
- Device: CUDA (GPU)

---

## 5.3 Why AdamW?

AdamW was selected instead of SGD because:

- Faster convergence
- Better stability for small training subsets
- Decoupled weight decay improves generalization

---

## 5.4 Learning Rate Scheduling

A StepLR scheduler was added:

- LR reduced every 2 epochs
- Prevents overshooting minima
- Stabilizes late-stage training

Observed behavior:
- Loss decreased consistently
- No instability or divergence

---

# 6. Training Results

Loss progression:

| Epoch | Avg Loss |
|--------|----------|
| 1 | 1.1542 |
| 2 | 0.9703 |
| 3 | 0.8052 |
| 4 | 0.7449 |
| 5 | 0.7023 |

This shows stable convergence and effective fine-tuning.

---

# 7. Strengths of This Architecture for BDD100K

- Handles multi-scale objects via FPN
- Robust region proposal mechanism
- Strong performance on dominant classes (car, person)
- Mature and reliable detection framework

---

# 8. Limitations Observed

From evaluation:

- Weak performance on rare classes (train)
- Struggles with small objects (bike, rider)
- Some class confusion (person vs rider)

These limitations stem from:
- Dataset imbalance
- Small object sizes
- Limited training epochs

---

# 9. Potential Improvements

## 9.1 Data-Level
- Class-balanced sampling
- Oversampling rare classes
- Augmentation targeting small objects

## 9.2 Model-Level
- Train for 10–20 epochs
- Use larger batch size
- Tune anchor sizes
- Use RetinaNet (focal loss for imbalance)
- Use more recent detectors (e.g., Faster R-CNN v2, DETR variants)

---

# 10. Conclusion

Faster R-CNN with ResNet50-FPN was selected due to:

- Strong baseline performance
- Multi-scale robustness
- Ease of adaptation
- Clear architectural interpretability

The model successfully converged and achieved:
`mAP@0.5 = 0.4183`

on the validation subset.

The architecture choice is well-aligned with the dataset characteristics and the assignment goals of building an end-to-end detection pipeline.

---

# End of Model Explanation